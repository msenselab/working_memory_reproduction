"0","#Predicated Indifference Point for Exp.4b"
"0","pred_model <- function(df) {"
"0","  lm(mu_r ~ curDur, data = df)"
"0","}"
"0",""
"0","pred_Inp_list <- AllDat_predY %>% "
"0","  dplyr::group_by(NSub, Exp, WMSize, gap) %>% nest()  %>%"
"0","  mutate(model = map(data, pred_model)) %>%  # linear regression"
"0","  mutate(slope = map(model, broom::tidy)) %>%  # get estimates"
"0","  unnest(slope, .drop = TRUE) %>% # remove raw data"
"0","  select(-std.error,-statistic, -p.value) %>%  # remove unnessary columns"
"0","  spread(term, estimate) %>%   # spread stimates"
"0","  dplyr::rename(Intercept = `(Intercept)`, pred_slope = curDur)  # rename columns"
"0","pred_Inp_list$model = NULL"
"0","pred_Inp_list$data = NULL"
"0","pred_Inp_list$pred_inP = pred_Inp_list$Intercept /(1-pred_Inp_list$pred_slope)"
